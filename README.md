### $赌狗社区预测游戏规则（BetDog v1）

这是一个运行在 **BSC链** 上的社区情绪预测游戏。玩家通过**消耗 $赌狗代币** 来参与“看涨 / 看跌”投票，投票结果直接影响代币的**自动做市行为**（回购销毁 or 控制性抛售），从而实现“社区集体决策驱动价格”。

#### 1. 参与门槛
- 钱包必须持有至少 **200,000 个 $赌狗**（代码中：`HOLD_THRESHOLD = 200000 * 10**18`）
- 每次押注固定消耗 **1,000 个 $赌狗**（代码中：`BET_SPEND = 1000 * 10**18`）
- 只能使用**外部拥有账户（EOA）**参与，**合约地址不允许押注**（防刷机制）
- 同一地址押注有 **60秒冷却**（`BET_COOLDOWN = 60 seconds`）

#### 2. 游戏轮次机制
- 每轮持续 **1小时**（`PREDICTION_DURATION = 1 hours`）
- 轮次开始后，任何符合条件的玩家可随时调用：
  - `betUp()` → 看涨（支持价格上涨）
  - `betDown()` → 看跌（支持控制抛售）
- 也可以使用 `batchBetUp(num)` / `batchBetDown(num)` 批量押注（最多一次30次，`MAX_BATCH_TIMES = 30`）
- 系统给**看涨方**初始赠送 **1,000 个**押注量（防止完全平局）
- 轮次结束1小时后，任何人可调用 `settleMarket()` 进行结算（通常由bot自动调用）

#### 3. 结算判定与做市操作
比较两边累计押注量（`upAmount` vs `downAmount`）：

- **涨方 ≥ 跌方** → **涨方获胜**
  - 使用**做市基金池（marketPoolEth）**的 **50%** BNB 进行**回购 $赌狗**
  - 回购得到的代币中 **30% 直接销毁**（去向 `DEAD` 地址）
  - 剩余70% 留在合约（可用于后续操作或增加流动性支撑）

- **跌方 > 涨方** → **跌方获胜**
  - 合约抛售持有的 $赌狗，**单次最大抛售量 = 流动性池中代币储备的 5%**（`MAX_SELL_BPS = 500`）
  - 抛售获得的 BNB 按以下比例重新分配：
    - 80% → 做市基金池（`marketPoolEth`）
    - 10% → 奖池（`potEthBalance`）
    - 10% → 抽奖池（`lotteryEthBalance`）

#### 4. 税收来源与分配（来自交易税）
所有做市、抽奖、最后押注者奖励的资金都来源于**代币交易税**，分配比例如下：

- **20%** → 奖池（Pot，用于最后押注者奖励）
- **10%** → 抽奖池（Lottery，用于轮次幸运抽奖）
- **70%** → 做市基金池（Market，用于回购/抛售操作）

#### 5. 最后押注者奖励（Last Bettor Bonus）
- 每次有人押注，会刷新“最后押注者”（`latestBettor`）并重置 **15分钟倒计时**（`BET_DURATION = 15 minutes`）
- 如果**15分钟内无人继续押注**，倒计时结束时：
  - 最后押注者可获得**当前奖池（potEthBalance）的 60%**（`WINNER_SHARE = 600`）
  - 奖励拆分：
    - **50%** 直接转 BNB 给获奖者
    - **50%** 用 BNB 通过 DEX/Portal **回购 $赌狗** 并转给获奖者
- 奖励**不是手动领取**，而是在**下一次有人押注**时自动触发发放（`_payoutIfExpired`）

#### 6. 社区抽奖（每轮结束触发）
- 只在**获胜阵营**的参与者中随机抽取 **1 名幸运儿**
- 幸运儿获得**抽奖池（lotteryEthBalance）的 80%** BNB
- 如果获胜方**无人参与**，则本轮不发抽奖
- 随机算法使用链上伪随机（`block.timestamp + prevrandao + nonce + msg.sender`）

#### 7. 如何参与（实际操作步骤）
1. 确保钱包持有 ≥ **200,000 $赌狗**
2. 对合约进行 **approve**，授权至少 1,000（或更多）$赌狗
3. 在轮次进行中的1小时内：
   - 调用 `betUp()` 或 `betDown()`（单次押1,000）
   - 或 `batchBetUp(num)` / `batchBetDown(num)` 批量押注
4. 尽量在轮次**后半段**（尤其是最后15分钟窗口）押注，有机会成为“最后押注者”吃60% Pot
5. 轮次结束后等待结算（`settleMarket`）
6. 如果中抽奖或最后押注者奖励，**BNB/代币会自动/延迟到账**

#### 核心亮点总结
- **社区情绪直接驱动做市**：涨赢→回购+销毁（利好），跌赢→限量抛售（控盘+补池）
- **多重收益路径**：
  1. 抽奖（80% lottery pool）
  2. 最后15分钟窗口抢 Pot 60%
  3. 长期持有受益于回购销毁机制
- 所有奖励资金**纯税费驱动**，无预挖、无额外注资
- 防刷设计：EOA限制 + 60秒冷却 + 批量上限 + 持有门槛

祝各位玩得开心，押对方向，一起把 $赌狗顶起来！🫡🐶

（以上内容已与提供的合约代码逐项对齐，如发现后续合约升级，请以最新代码为准）
